import{a as wt,e as u,d as S,t as Q,f,h as k,v as G,l as y,k as h,j as W,w as o,x as D,y as nt,z as Je,m as X,o as s,A as Ae,B as Z,n as ie,C as Et,r as St,q as ge,D as yt,E as be,F as Lt,p as st,G as ot}from"../chunks/scheduler.C56bEs1V.js";import{S as Ct,i as Tt,c as rt,b as it,m as ct,t as ut,a as ft,d as _t}from"../chunks/index.izBhtSeB.js";import{s as Ve,u as Ke,r as pt,m as mt,l as Nt}from"../chunks/stores.DdCjO8O4.js";import{e as Oe,u as At,L as dt,d as Ot,S as Fe,t as he,a as Pt}from"../chunks/app.C_WStDme.js";import{g as It}from"../chunks/entry.g_SyOvTS.js";function ht(a,t,e){const l=a.slice();return l[25]=t[e],l}function gt(a,t,e){const l=a.slice();return l[28]=t[e],l}function bt(a){let t,e,l='<i class="fa-solid fa-share-nodes"></i>',r,i;return{c(){t=u("span"),e=u("button"),e.innerHTML=l,this.h()},l(g){t=f(g,"SPAN",{class:!0});var _=k(t);e=f(_,"BUTTON",{"data-svelte-h":!0}),G(e)!=="svelte-102yhk5"&&(e.innerHTML=l),_.forEach(h),this.h()},h(){o(t,"class","text-xs text-amber-400 italic")},m(g,_){X(g,t,_),s(t,e),r||(i=Z(e,"click",a[8]),r=!0)},p:ie,d(g){g&&h(t),r=!1,i()}}}function vt(a,t){let e,l=t[28].name+"",r,i,g=t[28].lang+"",_,N,L;return{key:a,first:null,c(){e=u("option"),r=Q(l),i=Q(" ("),_=Q(g),N=Q(")"),this.h()},l(p){e=f(p,"OPTION",{});var v=k(e);r=W(v,l),i=W(v," ("),_=W(v,g),N=W(v,")"),v.forEach(h),this.h()},h(){e.__value=L=t[28].name+"|"+t[28].lang,D(e,e.__value),this.first=e},m(p,v){X(p,e,v),s(e,r),s(e,i),s(e,_),s(e,N)},p(p,v){t=p,v&32&&l!==(l=t[28].name+"")&&st(r,l),v&32&&g!==(g=t[28].lang+"")&&st(_,g),v&32&&L!==(L=t[28].name+"|"+t[28].lang)&&(e.__value=L,D(e,e.__value))},d(p){p&&h(e)}}}function kt(a){let t,e=a[25]+"",l;return{c(){t=u("option"),l=Q(e),this.h()},l(r){t=f(r,"OPTION",{});var i=k(t);l=W(i,e),i.forEach(h),this.h()},h(){t.__value=a[25],D(t,t.__value)},m(r,i){X(r,t,i),s(t,l)},p:ie,d(r){r&&h(t)}}}function xt(a){let t;return{c(){t=Q("Save")},l(e){t=W(e,"Save")},m(e,l){X(e,t,l)},p:ie,d(e){e&&h(t)}}}function Ut(a){let t,e;return{c(){t=u("span"),this.h()},l(l){t=f(l,"SPAN",{class:!0}),k(t).forEach(h),this.h()},h(){o(t,"class",e="loading loading-spinner loading-xs "+(a[7]?"visible":"invisible"))},m(l,r){X(l,t,r)},p(l,r){r&128&&e!==(e="loading loading-spinner loading-xs "+(l[7]?"visible":"invisible"))&&o(t,"class",e)},d(l){l&&h(t)}}}function Mt(a){let t;return{c(){t=Q("Save & Join")},l(e){t=W(e,"Save & Join")},m(e,l){X(e,t,l)},p:ie,d(e){e&&h(t)}}}function jt(a){let t,e;return{c(){t=u("span"),this.h()},l(l){t=f(l,"SPAN",{class:!0}),k(t).forEach(h),this.h()},h(){o(t,"class",e="loading loading-spinner loading-xs "+(a[7]?"visible":"invisible"))},m(l,r){X(l,t,r)},p(l,r){r&128&&e!==(e="loading loading-spinner loading-xs "+(l[7]?"visible":"invisible"))&&o(t,"class",e)},d(l){l&&h(t)}}}function Ht(a){let t,e,l,r="Karibu",i,g,_,N='<i class="fa-regular fa-user"></i>',L,p,v,A,K,C,P,ve="-- Select Game --",O=[],ce=new Map,ae,U,_e,Y,ue,pe,M,Pe='<i class="fa-solid fa-plus"></i> New Game',ke,b,m,w,me='<button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>',de,j,V="+ Add",Ie,$,ne,Ze="username",xe,R,Ue,ee,se,Qe="Game Name",Me,q,je,I,F,We="-- Select language --",He,te,z,Be,J,Ge,le,Xe="<button>close</button>",De,Ye,E=a[1]&&bt(a),we=Oe(a[5]);const $e=n=>n[28].id;for(let n=0;n<we.length;n+=1){let d=gt(a,we,n),c=$e(d);ce.set(c,O[n]=vt(c,d))}let fe=Oe(Object.values(dt)),T=[];for(let n=0;n<fe.length;n+=1)T[n]=kt(ht(a,fe,n));function et(n,d){return n[7]?Ut:xt}let Ce=et(a),H=Ce(a);function tt(n,d){return n[7]?jt:Mt}let Te=tt(a),B=Te(a);return{c(){t=u("div"),e=u("div"),l=u("span"),l.textContent=r,i=S(),g=u("label"),_=u("span"),_.innerHTML=N,L=S(),p=u("input"),v=S(),A=u("label"),E&&E.c(),K=S(),C=u("select"),P=u("option"),P.textContent=ve;for(let n=0;n<O.length;n+=1)O[n].c();ae=S(),U=u("button"),_e=Q(`Join Game
      `),Y=u("span"),pe=S(),M=u("button"),M.innerHTML=Pe,ke=S(),b=u("dialog"),m=u("div"),w=u("form"),w.innerHTML=me,de=S(),j=u("h3"),j.textContent=V,Ie=S(),$=u("label"),ne=u("span"),ne.textContent=Ze,xe=S(),R=u("input"),Ue=S(),ee=u("label"),se=u("span"),se.textContent=Qe,Me=S(),q=u("input"),je=S(),I=u("select"),F=u("option"),F.textContent=We;for(let n=0;n<T.length;n+=1)T[n].c();He=S(),te=u("div"),z=u("button"),H.c(),Be=Q(`
           
          `),J=u("button"),B.c(),Ge=S(),le=u("form"),le.innerHTML=Xe,this.h()},l(n){t=f(n,"DIV",{class:!0,style:!0});var d=k(t);e=f(d,"DIV",{class:!0});var c=k(e);l=f(c,"SPAN",{class:!0,"data-svelte-h":!0}),G(l)!=="svelte-19gzkk1"&&(l.textContent=r),i=y(c),g=f(c,"LABEL",{class:!0});var oe=k(g);_=f(oe,"SPAN",{class:!0,"data-svelte-h":!0}),G(_)!=="svelte-qxxlbp"&&(_.innerHTML=N),L=y(oe),p=f(oe,"INPUT",{type:!0,class:!0,placeholder:!0}),oe.forEach(h),v=y(c),A=f(c,"LABEL",{class:!0});var Ee=k(A);E&&E.l(Ee),K=y(Ee),C=f(Ee,"SELECT",{class:!0});var Re=k(C);P=f(Re,"OPTION",{"data-svelte-h":!0}),G(P)!=="svelte-7ry8ge"&&(P.textContent=ve);for(let re=0;re<O.length;re+=1)O[re].l(Re);Re.forEach(h),Ee.forEach(h),ae=y(c),U=f(c,"BUTTON",{class:!0,style:!0});var qe=k(U);_e=W(qe,`Join Game
      `),Y=f(qe,"SPAN",{class:!0}),k(Y).forEach(h),qe.forEach(h),pe=y(c),M=f(c,"BUTTON",{class:!0,style:!0,onclick:!0,"data-svelte-h":!0}),G(M)!=="svelte-2gb43q"&&(M.innerHTML=Pe),ke=y(c),b=f(c,"DIALOG",{id:!0,class:!0});var Se=k(b);m=f(Se,"DIV",{class:!0});var x=k(m);w=f(x,"FORM",{method:!0,"data-svelte-h":!0}),G(w)!=="svelte-9ixgud"&&(w.innerHTML=me),de=y(x),j=f(x,"H3",{class:!0,"data-svelte-h":!0}),G(j)!=="svelte-1krkdrr"&&(j.textContent=V),Ie=y(x),$=f(x,"LABEL",{class:!0});var ye=k($);ne=f(ye,"SPAN",{class:!0,"data-svelte-h":!0}),G(ne)!=="svelte-14xbfz6"&&(ne.textContent=Ze),xe=y(ye),R=f(ye,"INPUT",{type:!0,class:!0,placeholder:!0}),ye.forEach(h),Ue=y(x),ee=f(x,"LABEL",{class:!0});var Le=k(ee);se=f(Le,"SPAN",{class:!0,"data-svelte-h":!0}),G(se)!=="svelte-1hrenzd"&&(se.textContent=Qe),Me=y(Le),q=f(Le,"INPUT",{type:!0,class:!0,placeholder:!0}),Le.forEach(h),je=y(x),I=f(x,"SELECT",{class:!0});var ze=k(I);F=f(ze,"OPTION",{"data-svelte-h":!0}),G(F)!=="svelte-1ogokao"&&(F.textContent=We);for(let re=0;re<T.length;re+=1)T[re].l(ze);ze.forEach(h),He=y(x),te=f(x,"DIV",{class:!0});var Ne=k(te);z=f(Ne,"BUTTON",{class:!0});var lt=k(z);H.l(lt),lt.forEach(h),Be=W(Ne,`
           
          `),J=f(Ne,"BUTTON",{class:!0});var at=k(J);B.l(at),at.forEach(h),Ne.forEach(h),x.forEach(h),Ge=y(Se),le=f(Se,"FORM",{method:!0,class:!0,"data-svelte-h":!0}),G(le)!=="svelte-vg3lbk"&&(le.innerHTML=Xe),Se.forEach(h),c.forEach(h),d.forEach(h),this.h()},h(){o(l,"class","m-auto text-4xl uppercase text-white"),o(_,"class","text-xs text-amber-400 italic"),o(p,"type","text"),o(p,"class","grow"),o(p,"placeholder","e.g. Kimana"),o(g,"class","input input-bordered input-md flex items-center gap-2"),P.__value="",D(P,P.__value),o(C,"class","select select-md w-full outline-none focus:outline-none focus:ring-0"),a[1]===void 0&&nt(()=>a[12].call(C)),o(A,"class","input input-bordered input-md flex items-center gap-2"),o(Y,"class",ue="loading loading-spinner loading-xs "+(a[6]?"visible":"invisible")),o(U,"class","btn btn-neutral w-full"),Je(U,"width","100%"),o(M,"class","btn btn-outline btn-warning w-full"),Je(M,"width","100%"),o(M,"onclick","new_game_modal.showModal()"),o(w,"method","dialog"),o(j,"class","text-lg font-bold mb-4"),o(ne,"class","text-xs italic text-amber-400"),o(R,"type","text"),o(R,"class","grow"),o(R,"placeholder","e.g. Kimana"),o($,"class","input input-bordered input-md flex items-center gap-2 mb-3"),o(se,"class","text-xs italic text-amber-400"),o(q,"type","text"),o(q,"class","grow text-lg"),o(q,"placeholder","unique game name"),o(ee,"class","input input-bordered input-md flex items-center gap-2 mb-4"),F.__value="-- Select language --",D(F,F.__value),o(I,"class","select select-bordered select-md w-full mb-4"),a[4]===void 0&&nt(()=>a[16].call(I)),o(z,"class","btn btn-outline btn-warning w-1/3 disabled:btn-disabled"),z.disabled=a[7],o(J,"class","btn btn-warning w-2/3"),J.disabled=a[7],o(te,"class","flex flex-row"),o(m,"class","modal-box"),o(le,"method","dialog"),o(le,"class","modal-backdrop"),o(b,"id","new_game_modal"),o(b,"class","modal"),o(e,"class","card bg-slate-700 w-96 shadow-xl p-10 space-y-5 m-auto mt-48"),o(t,"class","w-full"),Je(t,"background-color","#fbf7f6")},m(n,d){X(n,t,d),s(t,e),s(e,l),s(e,i),s(e,g),s(g,_),s(g,L),s(g,p),D(p,a[0]),s(e,v),s(e,A),E&&E.m(A,null),s(A,K),s(A,C),s(C,P);for(let c=0;c<O.length;c+=1)O[c]&&O[c].m(C,null);Ae(C,a[1],!0),s(e,ae),s(e,U),s(U,_e),s(U,Y),s(e,pe),s(e,M),s(e,ke),s(e,b),s(b,m),s(m,w),s(m,de),s(m,j),s(m,Ie),s(m,$),s($,ne),s($,xe),s($,R),D(R,a[2]),s(m,Ue),s(m,ee),s(ee,se),s(ee,Me),s(ee,q),D(q,a[3]),s(m,je),s(m,I),s(I,F);for(let c=0;c<T.length;c+=1)T[c]&&T[c].m(I,null);Ae(I,a[4],!0),s(m,He),s(m,te),s(te,z),H.m(z,null),s(te,Be),s(te,J),B.m(J,null),s(b,Ge),s(b,le),De||(Ye=[Z(p,"input",a[11]),Z(C,"change",a[12]),Z(U,"click",a[13]),Z(R,"input",a[14]),Z(q,"input",a[15]),Z(I,"change",a[16]),Z(z,"click",a[17]),Z(J,"click",a[18])],De=!0)},p(n,[d]){if(d&1&&p.value!==n[0]&&D(p,n[0]),n[1]?E?E.p(n,d):(E=bt(n),E.c(),E.m(A,K)):E&&(E.d(1),E=null),d&32&&(we=Oe(n[5]),O=At(O,d,$e,1,n,we,ce,C,Ot,vt,null,gt)),d&34&&Ae(C,n[1]),d&64&&ue!==(ue="loading loading-spinner loading-xs "+(n[6]?"visible":"invisible"))&&o(Y,"class",ue),d&4&&R.value!==n[2]&&D(R,n[2]),d&8&&q.value!==n[3]&&D(q,n[3]),d&0){fe=Oe(Object.values(dt));let c;for(c=0;c<fe.length;c+=1){const oe=ht(n,fe,c);T[c]?T[c].p(oe,d):(T[c]=kt(oe),T[c].c(),T[c].m(I,null))}for(;c<T.length;c+=1)T[c].d(1);T.length=fe.length}d&16&&Ae(I,n[4]),Ce===(Ce=et(n))&&H?H.p(n,d):(H.d(1),H=Ce(n),H&&(H.c(),H.m(z,null))),d&128&&(z.disabled=n[7]),Te===(Te=tt(n))&&B?B.p(n,d):(B.d(1),B=Te(n),B&&(B.c(),B.m(J,null))),d&128&&(J.disabled=n[7])},i:ie,o:ie,d(n){n&&h(t),E&&E.d();for(let d=0;d<O.length;d+=1)O[d].d();Et(T,n),H.d(),B.d(),De=!1,St(Ye)}}}let Bt=!0;function Gt(a,t,e){let l,r,i,g;ge(a,Ve,b=>e(20,l=b)),ge(a,Ke,b=>e(21,r=b)),ge(a,pt,b=>e(22,i=b)),ge(a,mt,b=>e(23,g=b));let _="",N,L="",p="",v,A=[],K=!1,C=!1,P;yt(()=>{if(ve(),Object.keys(r).length>0){let{username:m,game:w}=r;l==null||l.emit("leave_game",{username:m,gameName:w==null?void 0:w.name,recoverTiles:i}),be(Ke,r={},r),be(mt,g=[],g),be(pt,i=null,i)}if(new URLSearchParams(location.search).has("game")){let m=location.search.split("=");e(1,N=decodeURIComponent(m[1].replaceAll("_"," ")))}}),Lt(()=>{clearInterval(P)});function ve(){clearInterval(P);const b=async()=>{const m=await fetch(Fe+"/api/games");e(5,A=await m.json())};P=setInterval(b,15e3),b()}function O(){let b=N.replaceAll(" ","_"),m=`https://api.whatsapp.com/send?text=${location.origin}?game=${encodeURIComponent(b)}`,w=location.origin+"?game="+encodeURIComponent(b);navigator.canShare()?navigator.share(w):window.open(m,"_blank")}const ce=b=>{var me;e(6,K=!0);let[m,w]=N.split("|");if(m==""||_=="")he.error("Please select a game and enter a username"),e(6,K=!1);else{e(0,_=_.charAt(0).toUpperCase()+_.slice(1));let de=b??((me=A.find(V=>V.created_by==_&&V.name==m))==null?void 0:me.created_by),j={username:_,game:{name:m,lang:w,admin:de}};be(Ke,r=j,r),l.emit("join_game",{username:j.username,game:j.game}),l.on("join_reply",V=>{V.status=="fail"?(he.error(V.message),e(6,K=!1)):V.status=="success"&&It("/game")})}},ae=async b=>{if(e(7,C=!0),L==""||p==""){he.error("Please enter a username and game name"),e(7,C=!1);return}e(0,_=L.charAt(0).toUpperCase()+L.slice(1)),e(3,p=p.charAt(0).toUpperCase()+p.slice(1)),e(3,p=p.replace(/[^a-zA-Z0-9]+/g," ").trim()),e(1,N=`${p}|${v}`);try{let w=await(await fetch(Fe+"/api/games/add",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:p,created_by:_,lang:v,use_scrabble_dictionary:Bt})})).json();w.status=="fail"?he.warning(w.error):(b&&ce(_),document.querySelector(".modal-backdrop>button").click()),e(7,C=!1)}catch{he.error("Error Communicating with the Server")}};function U(){_=this.value,e(0,_)}function _e(){N=ot(this),e(1,N),e(5,A)}const Y=()=>ce();function ue(){L=this.value,e(2,L)}function pe(){p=this.value,e(3,p)}function M(){v=ot(this),e(4,v)}return[_,N,L,p,v,A,K,C,O,ce,ae,U,_e,Y,ue,pe,M,()=>ae(),()=>ae(!0)]}class Dt extends Ct{constructor(t){super(),Tt(this,t,Gt,Ht,wt,{})}}function Rt(a){let t,e,l,r;return t=new Pt({props:{richColors:!0,position:"bottom-center"}}),l=new Dt({}),{c(){rt(t.$$.fragment),e=S(),rt(l.$$.fragment)},l(i){it(t.$$.fragment,i),e=y(i),it(l.$$.fragment,i)},m(i,g){ct(t,i,g),X(i,e,g),ct(l,i,g),r=!0},p:ie,i(i){r||(ut(t.$$.fragment,i),ut(l.$$.fragment,i),r=!0)},o(i){ft(t.$$.fragment,i),ft(l.$$.fragment,i),r=!1},d(i){i&&h(e),_t(t,i),_t(l,i)}}}function qt(a,t,e){let l;return ge(a,Ve,r=>e(0,l=r)),be(Ve,l=Nt.connect(Fe,{transports:["websocket","polling"]}),l),[]}class Zt extends Ct{constructor(t){super(),Tt(this,t,qt,Rt,wt,{})}}export{Zt as component};
