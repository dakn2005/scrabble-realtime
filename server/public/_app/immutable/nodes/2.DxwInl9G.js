import{s as rt,e as m,b as x,t as le,d as _,f as S,p as M,j as y,i as b,h as ae,q as i,r as j,v as Je,w as he,k as be,l,x as de,y as Y,n as ve,z as ct,A as mt,o as ue,B as _t,C as ce,D as pt,m as Ve,E as ze}from"../chunks/scheduler.C1Ol98Qv.js";import{S as it,i as ut,c as Qe,b as We,m as Xe,t as Ye,a as Ze,d as $e}from"../chunks/index.C7pQoyTu.js";import{e as ge,u as ft,s as Ie,a as Ae,r as et,m as tt,L as lt,d as ht,S as Me,t as ie,b as dt,l as gt}from"../chunks/app.DND8Z-wC.js";import{g as vt}from"../chunks/entry.DGy6yyF5.js";function at(s,t,e){const a=s.slice();return a[20]=t[e],a}function st(s,t,e){const a=s.slice();return a[23]=t[e],a}function nt(s,t){let e,a=t[23].name+"",u,r,h=t[23].lang+"",f,L,k;return{key:s,first:null,c(){e=m("option"),u=le(a),r=le(" ("),f=le(h),L=le(")"),this.h()},l(c){e=_(c,"OPTION",{});var g=S(e);u=ae(g,a),r=ae(g," ("),f=ae(g,h),L=ae(g,")"),g.forEach(b),this.h()},h(){e.__value=k=t[23].name+"|"+t[23].lang,j(e,e.__value),this.first=e},m(c,g){be(c,e,g),l(e,u),l(e,r),l(e,f),l(e,L)},p(c,g){t=c,g&32&&a!==(a=t[23].name+"")&&Ve(u,a),g&32&&h!==(h=t[23].lang+"")&&Ve(f,h),g&32&&k!==(k=t[23].name+"|"+t[23].lang)&&(e.__value=k,j(e,e.__value))},d(c){c&&b(e)}}}function ot(s){let t,e=s[20]+"",a;return{c(){t=m("option"),a=le(e),this.h()},l(u){t=_(u,"OPTION",{});var r=S(t);a=ae(r,e),r.forEach(b),this.h()},h(){t.__value=s[20],j(t,t.__value)},m(u,r){be(u,t,r),l(t,a)},p:ve,d(u){u&&b(t)}}}function bt(s){let t,e,a,u="Karibu",r,h,f,L="username",k,c,g,C,T,Z="-- Select Game --",E=[],se=new Map,ne,I,oe,H,$,re,p,N='<i class="fa-solid fa-plus"></i> New Game',q,O,v,J,je='<button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">âœ•</button>',we,V,Ue="+ Add",Ce,K,z,Ge="username",ke,U,xe,R,Q,Be="Game Name",ye,G,Te,P,B,De="-- Select language --",Ee,ee,D,He="Save",Se,F,qe="<button>close</button>",Ne,Ke,me=ge(s[5]);const Re=n=>n[23].id;for(let n=0;n<me.length;n+=1){let d=st(s,me,n),o=Re(d);se.set(o,E[n]=nt(o,d))}let te=ge(Object.values(lt)),w=[];for(let n=0;n<te.length;n+=1)w[n]=ot(at(s,te,n));return{c(){t=m("div"),e=m("div"),a=m("span"),a.textContent=u,r=x(),h=m("label"),f=m("span"),f.textContent=L,k=x(),c=m("input"),g=x(),C=m("select"),T=m("option"),T.textContent=Z;for(let n=0;n<E.length;n+=1)E[n].c();ne=x(),I=m("button"),oe=le(`Join Game
      `),H=m("span"),re=x(),p=m("button"),p.innerHTML=N,q=x(),O=m("dialog"),v=m("div"),J=m("form"),J.innerHTML=je,we=x(),V=m("h3"),V.textContent=Ue,Ce=x(),K=m("label"),z=m("span"),z.textContent=Ge,ke=x(),U=m("input"),xe=x(),R=m("label"),Q=m("span"),Q.textContent=Be,ye=x(),G=m("input"),Te=x(),P=m("select"),B=m("option"),B.textContent=De;for(let n=0;n<w.length;n+=1)w[n].c();Ee=x(),ee=m("form"),D=m("button"),D.textContent=He,Se=x(),F=m("form"),F.innerHTML=qe,this.h()},l(n){t=_(n,"DIV",{class:!0,style:!0});var d=S(t);e=_(d,"DIV",{class:!0});var o=S(e);a=_(o,"SPAN",{class:!0,"data-svelte-h":!0}),M(a)!=="svelte-19gzkk1"&&(a.textContent=u),r=y(o),h=_(o,"LABEL",{class:!0});var W=S(h);f=_(W,"SPAN",{class:!0,"data-svelte-h":!0}),M(f)!=="svelte-mkrndl"&&(f.textContent=L),k=y(W),c=_(W,"INPUT",{type:!0,class:!0,placeholder:!0}),W.forEach(b),g=y(o),C=_(o,"SELECT",{class:!0});var Oe=S(C);T=_(Oe,"OPTION",{"data-svelte-h":!0}),M(T)!=="svelte-7ry8ge"&&(T.textContent=Z);for(let X=0;X<E.length;X+=1)E[X].l(Oe);Oe.forEach(b),ne=y(o),I=_(o,"BUTTON",{class:!0,style:!0});var Le=S(I);oe=ae(Le,`Join Game
      `),H=_(Le,"SPAN",{class:!0}),S(H).forEach(b),Le.forEach(b),re=y(o),p=_(o,"BUTTON",{class:!0,style:!0,onclick:!0,"data-svelte-h":!0}),M(p)!=="svelte-2gb43q"&&(p.innerHTML=N),q=y(o),O=_(o,"DIALOG",{id:!0,class:!0});var _e=S(O);v=_(_e,"DIV",{class:!0});var A=S(v);J=_(A,"FORM",{method:!0,"data-svelte-h":!0}),M(J)!=="svelte-9ixgud"&&(J.innerHTML=je),we=y(A),V=_(A,"H3",{class:!0,"data-svelte-h":!0}),M(V)!=="svelte-1krkdrr"&&(V.textContent=Ue),Ce=y(A),K=_(A,"LABEL",{class:!0});var pe=S(K);z=_(pe,"SPAN",{class:!0,"data-svelte-h":!0}),M(z)!=="svelte-vl087v"&&(z.textContent=Ge),ke=y(pe),U=_(pe,"INPUT",{type:!0,class:!0,placeholder:!0}),pe.forEach(b),xe=y(A),R=_(A,"LABEL",{class:!0});var fe=S(R);Q=_(fe,"SPAN",{class:!0,"data-svelte-h":!0}),M(Q)!=="svelte-1e22p6m"&&(Q.textContent=Be),ye=y(fe),G=_(fe,"INPUT",{type:!0,class:!0,placeholder:!0}),fe.forEach(b),Te=y(A),P=_(A,"SELECT",{class:!0});var Pe=S(P);B=_(Pe,"OPTION",{"data-svelte-h":!0}),M(B)!=="svelte-1ogokao"&&(B.textContent=De);for(let X=0;X<w.length;X+=1)w[X].l(Pe);Pe.forEach(b),Ee=y(A),ee=_(A,"FORM",{method:!0});var Fe=S(ee);D=_(Fe,"BUTTON",{class:!0,style:!0,"data-svelte-h":!0}),M(D)!=="svelte-11ruwyt"&&(D.textContent=He),Fe.forEach(b),A.forEach(b),Se=y(_e),F=_(_e,"FORM",{method:!0,class:!0,"data-svelte-h":!0}),M(F)!=="svelte-vg3lbk"&&(F.innerHTML=qe),_e.forEach(b),o.forEach(b),d.forEach(b),this.h()},h(){i(a,"class","m-auto text-4xl uppercase text-white"),i(f,"class","text-xs text-indigo-200 italic"),i(c,"type","text"),i(c,"class","grow"),i(c,"placeholder","e.g. Kimana"),i(h,"class","input input-bordered input-md flex items-center gap-2"),T.__value="",j(T,T.__value),i(C,"class","select select-bordered select-md w-full max-w-xs"),s[1]===void 0&&Je(()=>s[10].call(C)),i(H,"class",$="loading loading-spinner loading-xs "+(s[6]?"visible":"invisible")),i(I,"class","btn btn-neutral w-full"),he(I,"width","100%"),i(p,"class","btn btn-outline btn-warning w-full"),he(p,"width","100%"),i(p,"onclick","new_game_modal.showModal()"),i(J,"method","dialog"),i(V,"class","text-lg font-bold mb-4"),i(z,"class","text-xs italic text-indigo-200"),i(U,"type","text"),i(U,"class","grow"),i(U,"placeholder","e.g. Kimana"),i(K,"class","input input-bordered input-md flex items-center gap-2 mb-3"),i(Q,"class","text-xs italic text-indigo-200"),i(G,"type","text"),i(G,"class","grow text-lg"),i(G,"placeholder","unique game name"),i(R,"class","input input-bordered input-md flex items-center gap-2 mb-4"),B.__value="-- Select language --",j(B,B.__value),i(P,"class","select select-bordered select-md w-full mb-4"),s[4]===void 0&&Je(()=>s[13].call(P)),i(D,"class","btn btn-primary w-full"),he(D,"width","100%"),i(ee,"method","dialog"),i(v,"class","modal-box"),i(F,"method","dialog"),i(F,"class","modal-backdrop"),i(O,"id","new_game_modal"),i(O,"class","modal"),i(e,"class","card bg-slate-700 w-96 shadow-xl p-10 space-y-5 m-auto mt-48"),i(t,"class","w-full"),he(t,"background-color","#fbf7f6")},m(n,d){be(n,t,d),l(t,e),l(e,a),l(e,r),l(e,h),l(h,f),l(h,k),l(h,c),j(c,s[0]),l(e,g),l(e,C),l(C,T);for(let o=0;o<E.length;o+=1)E[o]&&E[o].m(C,null);de(C,s[1],!0),l(e,ne),l(e,I),l(I,oe),l(I,H),l(e,re),l(e,p),l(e,q),l(e,O),l(O,v),l(v,J),l(v,we),l(v,V),l(v,Ce),l(v,K),l(K,z),l(K,ke),l(K,U),j(U,s[2]),l(v,xe),l(v,R),l(R,Q),l(R,ye),l(R,G),j(G,s[3]),l(v,Te),l(v,P),l(P,B);for(let o=0;o<w.length;o+=1)w[o]&&w[o].m(P,null);de(P,s[4],!0),l(v,Ee),l(v,ee),l(ee,D),l(O,Se),l(O,F),Ne||(Ke=[Y(c,"input",s[9]),Y(C,"change",s[10]),Y(I,"click",s[7]),Y(U,"input",s[11]),Y(G,"input",s[12]),Y(P,"change",s[13]),Y(D,"click",s[8])],Ne=!0)},p(n,[d]){if(d&1&&c.value!==n[0]&&j(c,n[0]),d&32&&(me=ge(n[5]),E=ft(E,d,Re,1,n,me,se,C,ht,nt,null,st)),d&34&&de(C,n[1]),d&64&&$!==($="loading loading-spinner loading-xs "+(n[6]?"visible":"invisible"))&&i(H,"class",$),d&4&&U.value!==n[2]&&j(U,n[2]),d&8&&G.value!==n[3]&&j(G,n[3]),d&0){te=ge(Object.values(lt));let o;for(o=0;o<te.length;o+=1){const W=at(n,te,o);w[o]?w[o].p(W,d):(w[o]=ot(W),w[o].c(),w[o].m(P,null))}for(;o<w.length;o+=1)w[o].d(1);w.length=te.length}d&16&&de(P,n[4])},i:ve,o:ve,d(n){n&&b(t);for(let d=0;d<E.length;d+=1)E[d].d();ct(w,n),Ne=!1,mt(Ke)}}}let wt=!0;function Ct(s,t,e){let a,u,r,h;ue(s,Ie,p=>e(15,a=p)),ue(s,Ae,p=>e(16,u=p)),ue(s,et,p=>e(17,r=p)),ue(s,tt,p=>e(18,h=p));let f="",L,k="",c="",g,C=[],T=!1,Z;_t(()=>{if(E(),Object.keys(u).length>0){let{username:p,game:N}=u;a==null||a.emit("leave_game",{username:p,gameName:N==null?void 0:N.name,recoverTiles:r}),ce(Ae,u={},u),ce(tt,h=[],h),ce(et,r=null,r)}}),pt(()=>{clearInterval(Z)});function E(){clearInterval(Z);const p=async()=>{const N=await fetch(Me+"/api/games");e(5,C=await N.json())};Z=setInterval(p,15e3),p()}const se=p=>{e(6,T=!0);let[N,q]=L.split("|");if(N==""||f=="")ie.error("Please select a game and enter a username"),e(6,T=!1);else{e(0,f=f.charAt(0).toUpperCase()+f.slice(1));let O={username:f,game:{name:N,lang:q}};ce(Ae,u=O,u),a.emit("join_game",{username:O.username,game:O.game}),a.on("join_reply",v=>{v.status=="fail"?(ie.error(v.message),e(6,T=!1)):v.status=="success"&&vt("/game")})}},ne=async p=>{if(p.preventDefault(),k==""||c==""){ie.error("Please enter a username and game name");return}e(0,f=k.charAt(0).toUpperCase()+k.slice(1)),e(3,c=c.charAt(0).toUpperCase()+c.slice(1)),e(1,L=`${c}|${g}`);try{let q=await(await fetch(Me+"/api/games/add",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:c,created_by:f,lang:g,use_scrabble_dictionary:wt})})).json();q.status=="fail"?ie.warning(q.error):se()}catch{ie.error("Error Communicating with the Server")}};function I(){f=this.value,e(0,f)}function oe(){L=ze(this),e(1,L),e(5,C)}function H(){k=this.value,e(2,k)}function $(){c=this.value,e(3,c)}function re(){g=ze(this),e(4,g)}return[f,L,k,c,g,C,T,se,ne,I,oe,H,$,re]}class kt extends it{constructor(t){super(),ut(this,t,Ct,bt,rt,{})}}function xt(s){let t,e,a,u;return t=new dt({props:{richColors:!0,position:"bottom-center"}}),a=new kt({}),{c(){Qe(t.$$.fragment),e=x(),Qe(a.$$.fragment)},l(r){We(t.$$.fragment,r),e=y(r),We(a.$$.fragment,r)},m(r,h){Xe(t,r,h),be(r,e,h),Xe(a,r,h),u=!0},p:ve,i(r){u||(Ye(t.$$.fragment,r),Ye(a.$$.fragment,r),u=!0)},o(r){Ze(t.$$.fragment,r),Ze(a.$$.fragment,r),u=!1},d(r){r&&b(e),$e(t,r),$e(a,r)}}}function yt(s,t,e){let a;return ue(s,Ie,u=>e(0,a=u)),ce(Ie,a=gt.connect(Me,{transports:["websocket","polling"]}),a),[]}class Ot extends it{constructor(t){super(),ut(this,t,yt,xt,rt,{})}}export{Ot as component};
