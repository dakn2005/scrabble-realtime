import{s as wt,e as u,b as E,t as Z,d as f,f as w,p as B,j as y,i as m,h as Q,q as o,r as G,v as nt,w as ze,k as W,l as s,x as Le,y as F,n as ie,z as Tt,A as Et,o as he,B as yt,C as ge,D as Lt,m as st,E as ot}from"../chunks/scheduler.e88Tslnl.js";import{S as Ct,i as St,c as rt,b as it,m as ct,t as ut,a as ft,d as _t}from"../chunks/index.a8bmwSpJ.js";import{e as Ne,u as Nt,s as Ke,a as Je,r as pt,m as mt,d as At,t as de,S as Ot,l as Pt}from"../chunks/app.DPoaeXwb.js";import{g as It}from"../chunks/entry.DAQCHAnX.js";let Ve="",dt={sheng:"Sheng + Swahili",swa:"Swahili",en:"English"};function ht(a,t,e){const l=a.slice();return l[24]=t[e],l}function gt(a,t,e){const l=a.slice();return l[27]=t[e],l}function bt(a){let t,e,l='<i class="fa-solid fa-share-nodes"></i>',r,i;return{c(){t=u("span"),e=u("button"),e.innerHTML=l,this.h()},l(d){t=f(d,"SPAN",{class:!0});var h=w(t);e=f(h,"BUTTON",{"data-svelte-h":!0}),B(e)!=="svelte-102yhk5"&&(e.innerHTML=l),h.forEach(m),this.h()},h(){o(t,"class","text-xs text-amber-400 italic")},m(d,h){W(d,t,h),s(t,e),r||(i=F(e,"click",a[8]),r=!0)},p:ie,d(d){d&&m(t),r=!1,i()}}}function vt(a,t){let e,l=t[27].name+"",r,i,d=t[27].lang+"",h,N,L;return{key:a,first:null,c(){e=u("option"),r=Z(l),i=Z(" ("),h=Z(d),N=Z(")"),this.h()},l(_){e=f(_,"OPTION",{});var v=w(e);r=Q(v,l),i=Q(v," ("),h=Q(v,d),N=Q(v,")"),v.forEach(m),this.h()},h(){e.__value=L=t[27].name+"|"+t[27].lang,G(e,e.__value),this.first=e},m(_,v){W(_,e,v),s(e,r),s(e,i),s(e,h),s(e,N)},p(_,v){t=_,v&32&&l!==(l=t[27].name+"")&&st(r,l),v&32&&d!==(d=t[27].lang+"")&&st(h,d),v&32&&L!==(L=t[27].name+"|"+t[27].lang)&&(e.__value=L,G(e,e.__value))},d(_){_&&m(e)}}}function kt(a){let t,e=a[24]+"",l;return{c(){t=u("option"),l=Z(e),this.h()},l(r){t=f(r,"OPTION",{});var i=w(t);l=Q(i,e),i.forEach(m),this.h()},h(){t.__value=a[24],G(t,t.__value)},m(r,i){W(r,t,i),s(t,l)},p:ie,d(r){r&&m(t)}}}function xt(a){let t;return{c(){t=Z("Save")},l(e){t=Q(e,"Save")},m(e,l){W(e,t,l)},p:ie,d(e){e&&m(t)}}}function Ut(a){let t,e;return{c(){t=u("span"),this.h()},l(l){t=f(l,"SPAN",{class:!0}),w(t).forEach(m),this.h()},h(){o(t,"class",e="loading loading-spinner loading-xs "+(a[7]?"visible":"invisible"))},m(l,r){W(l,t,r)},p(l,r){r&128&&e!==(e="loading loading-spinner loading-xs "+(l[7]?"visible":"invisible"))&&o(t,"class",e)},d(l){l&&m(t)}}}function Mt(a){let t;return{c(){t=Z("Save & Join")},l(e){t=Q(e,"Save & Join")},m(e,l){W(e,t,l)},p:ie,d(e){e&&m(t)}}}function jt(a){let t,e;return{c(){t=u("span"),this.h()},l(l){t=f(l,"SPAN",{class:!0}),w(t).forEach(m),this.h()},h(){o(t,"class",e="loading loading-spinner loading-xs "+(a[7]?"visible":"invisible"))},m(l,r){W(l,t,r)},p(l,r){r&128&&e!==(e="loading loading-spinner loading-xs "+(l[7]?"visible":"invisible"))&&o(t,"class",e)},d(l){l&&m(t)}}}function Ht(a){let t,e,l,r="Karibu",i,d,h,N='<i class="fa-regular fa-user"></i>',L,_,v,O,K,C,P,be="-- Select Game --",A=[],_e=new Map,le,U,pe,X,ce,me,D,Ae='<i class="fa-solid fa-plus"></i> New Game',k,b,g,M,ue='<button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>',Oe,ae,Fe="+ Add",Pe,Y,ne,Ze="username",Ie,R,xe,$,se,Qe="Game Name",Ue,q,Me,I,V,We="-- Select language --",je,ee,z,He,J,Be,te,Xe="<button>close</button>",Ge,Ye,T=a[1]&&bt(a),ve=Ne(a[5]);const $e=n=>n[27].id;for(let n=0;n<ve.length;n+=1){let p=gt(a,ve,n),c=$e(p);_e.set(c,A[n]=vt(c,p))}let fe=Ne(Object.values(dt)),S=[];for(let n=0;n<fe.length;n+=1)S[n]=kt(ht(a,fe,n));function et(n,p){return n[7]?Ut:xt}let ke=et(a),j=ke(a);function tt(n,p){return n[7]?jt:Mt}let we=tt(a),H=we(a);return{c(){t=u("div"),e=u("div"),l=u("span"),l.textContent=r,i=E(),d=u("label"),h=u("span"),h.innerHTML=N,L=E(),_=u("input"),v=E(),O=u("label"),T&&T.c(),K=E(),C=u("select"),P=u("option"),P.textContent=be;for(let n=0;n<A.length;n+=1)A[n].c();le=E(),U=u("button"),pe=Z(`Join Game
      `),X=u("span"),me=E(),D=u("button"),D.innerHTML=Ae,k=E(),b=u("dialog"),g=u("div"),M=u("form"),M.innerHTML=ue,Oe=E(),ae=u("h3"),ae.textContent=Fe,Pe=E(),Y=u("label"),ne=u("span"),ne.textContent=Ze,Ie=E(),R=u("input"),xe=E(),$=u("label"),se=u("span"),se.textContent=Qe,Ue=E(),q=u("input"),Me=E(),I=u("select"),V=u("option"),V.textContent=We;for(let n=0;n<S.length;n+=1)S[n].c();je=E(),ee=u("div"),z=u("button"),j.c(),He=Z(`
           
          `),J=u("button"),H.c(),Be=E(),te=u("form"),te.innerHTML=Xe,this.h()},l(n){t=f(n,"DIV",{class:!0,style:!0});var p=w(t);e=f(p,"DIV",{class:!0});var c=w(e);l=f(c,"SPAN",{class:!0,"data-svelte-h":!0}),B(l)!=="svelte-19gzkk1"&&(l.textContent=r),i=y(c),d=f(c,"LABEL",{class:!0});var oe=w(d);h=f(oe,"SPAN",{class:!0,"data-svelte-h":!0}),B(h)!=="svelte-qxxlbp"&&(h.innerHTML=N),L=y(oe),_=f(oe,"INPUT",{type:!0,class:!0,placeholder:!0}),oe.forEach(m),v=y(c),O=f(c,"LABEL",{class:!0});var Ce=w(O);T&&T.l(Ce),K=y(Ce),C=f(Ce,"SELECT",{class:!0});var De=w(C);P=f(De,"OPTION",{"data-svelte-h":!0}),B(P)!=="svelte-7ry8ge"&&(P.textContent=be);for(let re=0;re<A.length;re+=1)A[re].l(De);De.forEach(m),Ce.forEach(m),le=y(c),U=f(c,"BUTTON",{class:!0,style:!0});var Re=w(U);pe=Q(Re,`Join Game
      `),X=f(Re,"SPAN",{class:!0}),w(X).forEach(m),Re.forEach(m),me=y(c),D=f(c,"BUTTON",{class:!0,style:!0,onclick:!0,"data-svelte-h":!0}),B(D)!=="svelte-2gb43q"&&(D.innerHTML=Ae),k=y(c),b=f(c,"DIALOG",{id:!0,class:!0});var Se=w(b);g=f(Se,"DIV",{class:!0});var x=w(g);M=f(x,"FORM",{method:!0,"data-svelte-h":!0}),B(M)!=="svelte-9ixgud"&&(M.innerHTML=ue),Oe=y(x),ae=f(x,"H3",{class:!0,"data-svelte-h":!0}),B(ae)!=="svelte-1krkdrr"&&(ae.textContent=Fe),Pe=y(x),Y=f(x,"LABEL",{class:!0});var Te=w(Y);ne=f(Te,"SPAN",{class:!0,"data-svelte-h":!0}),B(ne)!=="svelte-14xbfz6"&&(ne.textContent=Ze),Ie=y(Te),R=f(Te,"INPUT",{type:!0,class:!0,placeholder:!0}),Te.forEach(m),xe=y(x),$=f(x,"LABEL",{class:!0});var Ee=w($);se=f(Ee,"SPAN",{class:!0,"data-svelte-h":!0}),B(se)!=="svelte-1hrenzd"&&(se.textContent=Qe),Ue=y(Ee),q=f(Ee,"INPUT",{type:!0,class:!0,placeholder:!0}),Ee.forEach(m),Me=y(x),I=f(x,"SELECT",{class:!0});var qe=w(I);V=f(qe,"OPTION",{"data-svelte-h":!0}),B(V)!=="svelte-1ogokao"&&(V.textContent=We);for(let re=0;re<S.length;re+=1)S[re].l(qe);qe.forEach(m),je=y(x),ee=f(x,"DIV",{class:!0});var ye=w(ee);z=f(ye,"BUTTON",{class:!0});var lt=w(z);j.l(lt),lt.forEach(m),He=Q(ye,`
           
          `),J=f(ye,"BUTTON",{class:!0});var at=w(J);H.l(at),at.forEach(m),ye.forEach(m),x.forEach(m),Be=y(Se),te=f(Se,"FORM",{method:!0,class:!0,"data-svelte-h":!0}),B(te)!=="svelte-vg3lbk"&&(te.innerHTML=Xe),Se.forEach(m),c.forEach(m),p.forEach(m),this.h()},h(){o(l,"class","m-auto text-4xl uppercase text-white"),o(h,"class","text-xs text-amber-400 italic"),o(_,"type","text"),o(_,"class","grow"),o(_,"placeholder","e.g. Kimana"),o(d,"class","input input-bordered input-md flex items-center gap-2"),P.__value="",G(P,P.__value),o(C,"class","select select-md w-full outline-none focus:outline-none focus:ring-0"),a[1]===void 0&&nt(()=>a[12].call(C)),o(O,"class","input input-bordered input-md flex items-center gap-2"),o(X,"class",ce="loading loading-spinner loading-xs "+(a[6]?"visible":"invisible")),o(U,"class","btn btn-neutral w-full"),ze(U,"width","100%"),o(D,"class","btn btn-outline btn-warning w-full"),ze(D,"width","100%"),o(D,"onclick","new_game_modal.showModal()"),o(M,"method","dialog"),o(ae,"class","text-lg font-bold mb-4"),o(ne,"class","text-xs italic text-amber-400"),o(R,"type","text"),o(R,"class","grow"),o(R,"placeholder","e.g. Kimana"),o(Y,"class","input input-bordered input-md flex items-center gap-2 mb-3"),o(se,"class","text-xs italic text-amber-400"),o(q,"type","text"),o(q,"class","grow text-lg"),o(q,"placeholder","unique game name"),o($,"class","input input-bordered input-md flex items-center gap-2 mb-4"),V.__value="-- Select language --",G(V,V.__value),o(I,"class","select select-bordered select-md w-full mb-4"),a[4]===void 0&&nt(()=>a[15].call(I)),o(z,"class","btn btn-outline btn-warning w-1/3 disabled:btn-disabled"),z.disabled=a[7],o(J,"class","btn btn-warning w-2/3"),J.disabled=a[7],o(ee,"class","flex flex-row"),o(g,"class","modal-box"),o(te,"method","dialog"),o(te,"class","modal-backdrop"),o(b,"id","new_game_modal"),o(b,"class","modal"),o(e,"class","card bg-slate-700 w-96 shadow-xl p-10 space-y-5 m-auto mt-48"),o(t,"class","w-full"),ze(t,"background-color","#fbf7f6")},m(n,p){W(n,t,p),s(t,e),s(e,l),s(e,i),s(e,d),s(d,h),s(d,L),s(d,_),G(_,a[0]),s(e,v),s(e,O),T&&T.m(O,null),s(O,K),s(O,C),s(C,P);for(let c=0;c<A.length;c+=1)A[c]&&A[c].m(C,null);Le(C,a[1],!0),s(e,le),s(e,U),s(U,pe),s(U,X),s(e,me),s(e,D),s(e,k),s(e,b),s(b,g),s(g,M),s(g,Oe),s(g,ae),s(g,Pe),s(g,Y),s(Y,ne),s(Y,Ie),s(Y,R),G(R,a[2]),s(g,xe),s(g,$),s($,se),s($,Ue),s($,q),G(q,a[3]),s(g,Me),s(g,I),s(I,V);for(let c=0;c<S.length;c+=1)S[c]&&S[c].m(I,null);Le(I,a[4],!0),s(g,je),s(g,ee),s(ee,z),j.m(z,null),s(ee,He),s(ee,J),H.m(J,null),s(b,Be),s(b,te),Ge||(Ye=[F(_,"input",a[11]),F(C,"change",a[12]),F(U,"click",a[9]),F(R,"input",a[13]),F(q,"input",a[14]),F(I,"change",a[15]),F(z,"click",a[16]),F(J,"click",a[17])],Ge=!0)},p(n,[p]){if(p&1&&_.value!==n[0]&&G(_,n[0]),n[1]?T?T.p(n,p):(T=bt(n),T.c(),T.m(O,K)):T&&(T.d(1),T=null),p&32&&(ve=Ne(n[5]),A=Nt(A,p,$e,1,n,ve,_e,C,At,vt,null,gt)),p&34&&Le(C,n[1]),p&64&&ce!==(ce="loading loading-spinner loading-xs "+(n[6]?"visible":"invisible"))&&o(X,"class",ce),p&4&&R.value!==n[2]&&G(R,n[2]),p&8&&q.value!==n[3]&&G(q,n[3]),p&0){fe=Ne(Object.values(dt));let c;for(c=0;c<fe.length;c+=1){const oe=ht(n,fe,c);S[c]?S[c].p(oe,p):(S[c]=kt(oe),S[c].c(),S[c].m(I,null))}for(;c<S.length;c+=1)S[c].d(1);S.length=fe.length}p&16&&Le(I,n[4]),ke===(ke=et(n))&&j?j.p(n,p):(j.d(1),j=ke(n),j&&(j.c(),j.m(z,null))),p&128&&(z.disabled=n[7]),we===(we=tt(n))&&H?H.p(n,p):(H.d(1),H=we(n),H&&(H.c(),H.m(J,null))),p&128&&(J.disabled=n[7])},i:ie,o:ie,d(n){n&&m(t),T&&T.d();for(let p=0;p<A.length;p+=1)A[p].d();Tt(S,n),j.d(),H.d(),Ge=!1,Et(Ye)}}}let Bt=!0;function Gt(a,t,e){let l,r,i,d;he(a,Ke,k=>e(19,l=k)),he(a,Je,k=>e(20,r=k)),he(a,pt,k=>e(21,i=k)),he(a,mt,k=>e(22,d=k));let h="",N,L="",_="",v,O=[],K=!1,C=!1,P;yt(()=>{if(be(),Object.keys(r).length>0){let{username:b,game:g}=r;l==null||l.emit("leave_game",{username:b,gameName:g==null?void 0:g.name,recoverTiles:i}),ge(Je,r={},r),ge(mt,d=[],d),ge(pt,i=null,i)}if(new URLSearchParams(location.search).has("game")){let b=location.search.split("=");e(1,N=decodeURIComponent(b[1].replaceAll("_"," ")))}}),Lt(()=>{clearInterval(P)});function be(){clearInterval(P);const k=async()=>{const b=await fetch(Ve+"/api/games");e(5,O=await b.json())};P=setInterval(k,15e3),k()}function A(){let k=N.replaceAll(" ","_"),b=`https://api.whatsapp.com/send?text=${location.origin}?game=${encodeURIComponent(k)}`,g=location.origin+"?game="+encodeURIComponent(k);navigator.canShare()?navigator.share(g):window.open(b,"_blank")}const _e=k=>{e(6,K=!0);let[b,g]=N.split("|");if(b==""||h=="")de.error("Please select a game and enter a username"),e(6,K=!1);else{e(0,h=h.charAt(0).toUpperCase()+h.slice(1));let M={username:h,game:{name:b,lang:g}};ge(Je,r=M,r),l.emit("join_game",{username:M.username,game:M.game}),l.on("join_reply",ue=>{ue.status=="fail"?(de.error(ue.message),e(6,K=!1)):ue.status=="success"&&It("/game")})}},le=async k=>{if(e(7,C=!0),L==""||_==""){de.error("Please enter a username and game name"),e(7,C=!1);return}e(0,h=L.charAt(0).toUpperCase()+L.slice(1)),e(3,_=_.charAt(0).toUpperCase()+_.slice(1)),e(3,_=_.replace(/[^a-zA-Z0-9]+/g," ").trim()),e(1,N=`${_}|${v}`);try{let g=await(await fetch(Ve+"/api/games/add",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({name:_,created_by:h,lang:v,use_scrabble_dictionary:Bt})})).json();g.status=="fail"?de.warning(g.error):(k&&_e(),document.querySelector(".modal-backdrop>button").click()),e(7,C=!1)}catch{de.error("Error Communicating with the Server")}};function U(){h=this.value,e(0,h)}function pe(){N=ot(this),e(1,N),e(5,O)}function X(){L=this.value,e(2,L)}function ce(){_=this.value,e(3,_)}function me(){v=ot(this),e(4,v)}return[h,N,L,_,v,O,K,C,A,_e,le,U,pe,X,ce,me,()=>le(),()=>le(!0)]}class Dt extends Ct{constructor(t){super(),St(this,t,Gt,Ht,wt,{})}}function Rt(a){let t,e,l,r;return t=new Ot({props:{richColors:!0,position:"bottom-center"}}),l=new Dt({}),{c(){rt(t.$$.fragment),e=E(),rt(l.$$.fragment)},l(i){it(t.$$.fragment,i),e=y(i),it(l.$$.fragment,i)},m(i,d){ct(t,i,d),W(i,e,d),ct(l,i,d),r=!0},p:ie,i(i){r||(ut(t.$$.fragment,i),ut(l.$$.fragment,i),r=!0)},o(i){ft(t.$$.fragment,i),ft(l.$$.fragment,i),r=!1},d(i){i&&m(e),_t(t,i),_t(l,i)}}}function qt(a,t,e){let l;return he(a,Ke,r=>e(0,l=r)),ge(Ke,l=Pt.connect(Ve,{transports:["websocket","polling"]}),l),[]}class Ft extends Ct{constructor(t){super(),St(this,t,qt,Rt,wt,{})}}export{Ft as component};
